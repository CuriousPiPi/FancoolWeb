/* ========== 侧边栏布局 ========== */
#sidebar {
  position:fixed; top:0; left:0; height:100vh; width:450px;
  background:var(--bg-secondary);
  border-right:1px solid var(--border-color);
  box-shadow:2px 0 10px var(--shadow-color);
  z-index:50; display:flex; flex-direction:column;
  transform:translateX(0);
  transition:transform var(--transition-speed) ease, width .12s ease;
  overflow:hidden;
}
#sidebar.collapsed { transform:translateX(-100%); }
#main-content { margin-left:0; transition:margin-left var(--transition-speed) ease; }

#top-panel .sidebar-panel-content {
  overflow-y: hidden !important;
  overflow-x: hidden !important;
}

.sidebar-panel { display:flex; flex-direction:column; overflow:hidden; }
.sidebar-panel-content {
  --sp-pad-top: 8px;
  --sp-pad-x: 0;
  --sp-pad-bottom: 24px;
  flex-grow:1;
  padding: var(--sp-pad-top) var(--sp-pad-x) var(--sp-pad-bottom);
  scrollbar-color: var(--border-color) var(--bg-secondary);
}    
#bottom-panel { transition:flex-basis .35s ease, height .35s ease; }

/* ========== 分隔条 ========== */
#sidebar-splitter {
  position: relative;
  height: 12px;
  background: var(--bg-primary);
  border: 0;
  z-index: 200;
  isolation: isolate;
  box-shadow: none;
} 

#sidebar-splitter .splitter-handle {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%,-50%);
  width: 72px;
  height: 24px;
  border-radius: 9999px;
  background: var(--bg-secondary);
  border: 1px solid var(--border-color);
  box-shadow: 0 1px 2px rgba(0,0,0,.08);
  cursor: ns-resize;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  touch-action: none;
  user-select: none;
  -webkit-user-select: none;
  pointer-events: auto;
}

#sidebar-splitter .splitter-handle::before {
  content: "";
  width: 26px;
  height: 10px;
  border-radius: 9999px;
  background:
    repeating-linear-gradient(
      to bottom,
      var(--border-color) 0px, var(--border-color) 1px,
      transparent 1px, transparent 4px
    );
  opacity: .75;
}

#sidebar-splitter .splitter-handle:hover {
  border-color: #93c5fd;
  box-shadow: 0 1px 3px rgba(0,0,0,.12);
}
#sidebar-splitter .splitter-handle:active {
  transform: translate(-50%,-50%) scale(.98);
}

@media (hover: none) and (pointer: coarse) {
  #sidebar-splitter .splitter-handle {
    width: 92px;
    height: 30px;
  }
}

#sidebar-resizer {
  position:absolute; top:0; right:0; width:6px; height:100%;
  cursor:ew-resize; z-index:70; pointer-events:auto;
  touch-action: none;
}
#sidebar-resizer:hover { background:rgba(0,0,0,.08); }

/* ========== 页签内容 ========== */
.tab-content-container { overflow:hidden; position:relative; min-height:460px; }
.tab-content-wrapper { display:flex; width:200%; transition:transform .45s cubic-bezier(.4,0,.2,1); }
.tab-pane { width:50%; flex-shrink:0; padding:0 2px; }

/* ========== 分段控件 ========== */
.right-subseg { display:flex; align-items:center; gap:.5rem; min-height:42px; }
.right-subseg .seg { margin:0; }

.seg { position:relative; display:inline-flex; gap:0; padding:3px; border:1px solid var(--border-color); border-radius:9999px; background:var(--bg-secondary); }
.seg-btn { position:relative; z-index:1; padding:6px 12px; border-radius:9999px; font-weight:600; color:var(--text-secondary); background:none; border:none; cursor:pointer; transition:.2s; font-size:13px; }
.seg-btn.is-active { color:var(--text-primary); }
.seg-thumb { position:absolute; inset:3px auto 3px 3px; width:calc(50% - 3px); border-radius:9999px; background:rgba(59,130,246,.12); transition:transform .25s ease; }
.seg[data-active$="likes-panel"] .seg-thumb { transform:translateX(100%); }
[data-theme="dark"] .seg-thumb { background:rgba(95,163,255,.14); }

/* ========== 排行榜面板 ========== */
.rank-panel { display:none; animation:fadePanel .25s ease; }
.rank-panel.active { display:block; }
@keyframes fadePanel { from { opacity:0; transform:translateY(8px);} to {opacity:1; transform:translateY(0);} }

.rank-table-scroll { max-height:360px; overflow:auto; padding-top:0; background:var(--bg-secondary); scrollbar-gutter: stable both-edges; }
.rank-table-scroll::-webkit-scrollbar { width:8px; }
.rank-table-scroll::-webkit-scrollbar-thumb { background:var(--border-color); border-radius:4px; }
.rank-table-scroll::-webkit-scrollbar-thumb:hover { background:var(--text-secondary); }

.ranking-table { width:100%; border-collapse:separate; border-spacing:0; }
.ranking-table th, 
.ranking-table td { padding:.6rem; vertical-align:middle; font-size:14px; }
.ranking-table th { text-align:left; white-space:nowrap; font-weight:600; letter-spacing:.5px; }

/* ========== 主内容区域 ========== */
#main-content {
  display: flex;
  flex-direction: column;
  height: 100vh;
  overflow: hidden;
}

#top-container {
  flex: 0 0 auto;
  padding: 20px 25px 0;
  background: var(--bg-primary);
}

#chart-container {
  flex: 1 1 auto;
  overflow: hidden;
  background: var(--bg-secondary);
  border-radius: 12px 12px 0 0;
  margin: 20px 25px 0;
  display: flex;
  flex-direction: column;
}

/* ========== 侧栏页签顶部固定 ========== */
#top-panel .tab-nav {
  position: sticky;
  top: calc(-1 * var(--header-divider-offset)) !important;
  z-index: 60;
  background: var(--bg-secondary);
  box-shadow: none;
  border-bottom: 0;
}

#top-panel .tab-nav .tab-nav-item {
  margin-bottom: 0 !important;
}
#top-panel .tab-nav .tab-nav-item.active { border-bottom-color: #3B82F6 !important; z-index: 60; }